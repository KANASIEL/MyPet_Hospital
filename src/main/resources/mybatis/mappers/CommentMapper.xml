<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.boot.dao.CommunityCommentDAO">

    <!-- 댓글 저장 -->
    <insert id="save">
	    INSERT INTO COMMUNITY_COMMENT (
	          comment_no
	        , post_no
	        , user_no
	        , user_name
	        , comment_content
	        , created_at
	    ) VALUES (
	          SEQ_COMMUNITY_COMMENT_NO.NEXTVAL
	        , #{post_no}
	        , #{user_no}
	        , #{user_name}
	        , #{comment_content}
	        , SYSDATE
	    )
	</insert>


    <!-- 댓글 목록 조회 (Oracle 버전) -->
    <select id="findAll" resultType="com.boot.dto.Mypet_Community_CommentDTO">
        SELECT 
              comment_no
            , post_no
            , user_no
            , user_name
            , comment_content
            , TO_CHAR(created_at, 'YYYY-MM-DD HH24:MI') AS created_at2
        FROM COMMUNITY_COMMENT
        WHERE post_no = #{post_no}
        ORDER BY comment_no
    </select>
    
    <delete id="deleteComment">
		delete from COMMUNITY_COMMENT where COMMENT_NO=#{comment_no}
	</delete>

	<delete id="deleteByPostNo" parameterType="int">
    	DELETE FROM COMMUNITY_COMMENT
    	WHERE POST_NO = #{postNo}
	</delete>
</mapper>
